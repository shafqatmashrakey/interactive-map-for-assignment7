<!DOCTYPE html>
<html lang="en">

<head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Interactive Map</title>

    <link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />
    <link rel="stylesheet" href="https://classless.de/classless.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <style>
        html,
        body {
            height: 100%;
            margin: 0;
        }

        .leaflet-container {
            height: 400px;
            width: 600px;
            max-width: 100%;
            max-height: 100%;
        }

        #summary {
            margin-top: 20px;
        }
        .title {
            font-size: 2em;
            margin-bottom: 20px;
        }

        .video-container {
            position: relative;
            padding-bottom: 56.25%;
            padding-top: 25px;
            height: 0;
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>


</head>

<body>
    <div class="title">Interactive Map</div>

    
    <div id='map'></div>
    <div id="summary"></div>
    
    <div>
        <label for="dateSelector">Select a Date:</label>
        <select id="dateSelector">
            <option value="2024-04-17">April 17, 2024</option>
            <option value="2024-04-18">April 18, 2024</option>
            <option value="2024-04-19">April 19, 2024</option>
        </select>
        <button onclick="loadMarkers()">Load Markers</button>
    </div><br><br>
    <div class="title">Video Tutorial</div>
    <div class="video-container">
        <iframe width="560" height="315" src="summary2.mp4" frameborder="0"
            allowfullscreen></iframe>
    </div>

    <script>
        const markersData = {
            'Yosemite National Park': {
                latlng: [37.8651, -119.5383],
                features: {
                    feature1: { name: 'Location', value: 'California' },
                    feature2: { name: 'Population', value: '39.5 million' },
                    feature3: { name: 'Capital', value: 'Sacramento' }

                }
            },
            'Disneyland': {
                latlng: [33.8121, -117.9190],
                features: {
                    feature1: { name: 'Location', value: 'California' },
                    feature2: { name: 'Population', value: '39.5 million' },
                    feature3: { name: 'Capital', value: 'Sacramento' }
                }
            },
            'Golden Gate Bridge': {
                latlng: [37.8199, -122.4783],
                features: {
                    feature1: { name: 'Location', value: 'California' },
                    feature2: { name: 'Population', value: '39.5 million' },
                    feature3: { name: 'Capital', value: 'Sacramento' }
                }
            },
            'Statue of Liberty': {
                latlng: [40.6892, -74.0445],
                features: {
                    feature1: { name: 'Location', value: 'New York' },
                    feature2: { name: 'Population', value: '19.5 million' },
                    feature3: { name: 'Capital', value: 'Albany' }
                }
            },
            'Walt Disney World': {
                latlng: [28.3852, -81.5639],
                features: {
                    feature1: { name: 'Location', value: 'Florida' },
                    feature2: { name: 'Population', value: '21.5 million' },
                    feature3: { name: 'Capital', value: 'Tallahassee' }
                }
            }
        };

        const osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        });

        const map = L.map('map', {
            center: [37.0902, -95.7129],
            zoom: 4,
            layers: [osm]
        });

        let currentMarkers = [];

        function loadMarkers() {
            const selectedDate = document.getElementById('dateSelector').value;
            clearMarkers();

            Object.keys(markersData).forEach(observer => {
                const observerData = markersData[observer];
                const popupContent = createPopupContent(observer, observerData.features, getObservationValues(observerData, selectedDate));
                const marker = L.marker(observerData.latlng).bindPopup(popupContent);
                currentMarkers.push(marker);
                marker.addTo(map);
            });
        }

        function clearMarkers() {
            currentMarkers.forEach(marker => {
                marker.remove();
            });
            currentMarkers = [];
        }

        function getObservationValues(observerData, selectedDate) {
            const weatherConditions = ['sunny', 'rainy', 'cloudy', 'partly cloudy', 'windy', 'snowy', 'foggy'];
            const randomIndex = Math.floor(Math.random() * weatherConditions.length);
            const randomCondition = weatherConditions[randomIndex];

            return {
                description: randomCondition
            };
        }


        function createPopupContent(name, features, observationValues) {
            let content = `<strong>${name}</strong><br>`;
            Object.values(features).forEach(feature => {
                content += `${feature.name}: ${feature.value}<br>`;
            });
            content += `<hr>`;
            content += `<strong>Weather (${document.getElementById('dateSelector').value}):</strong><br>`;
            content += `Description: ${observationValues.description}<br>`;
            return content;
        }

    </script>

</body>

</html>
